
> jp-equity-backtest-app@0.1.0 test
> vitest run --coverage


 RUN  v1.6.1 /home/takeru/react_projects/backtest-app
      Coverage enabled with v8

stdout | src/lib/bundle-size.test.ts > Bundle Size Tests > should have gzip bundle size < 3.7 MB
Bundle size: 0.80 MB

stdout | src/lib/bundle-size.test.ts > Bundle Size Tests > should have reasonable chunk sizes
JS chunks: 1, CSS chunks: 1

stdout | src/lib/bundle-size.test.ts > Bundle Size Tests > should load DuckDB-WASM assets efficiently
Worker size: 0.19 MB

 ✓ src/lib/dslSchema.spec.ts > DSL Schema > should pass a dummy test
 ✓ src/worker/worker.spec.ts > Worker > should pass a dummy test
 ✓ src/lib/bundle-size.test.ts > Bundle Size Tests > should have gzip bundle size < 3.7 MB
 ✓ src/lib/bundle-size.test.ts > Bundle Size Tests > should have reasonable chunk sizes
 ✓ src/lib/bundle-size.test.ts > Bundle Size Tests > should load DuckDB-WASM assets efficiently
 ✓ src/lib/dsl-validator.test.ts > AST Validation > should validate a valid AST
 ✓ src/lib/dsl-validator.test.ts > AST Validation > should reject invalid function names
 ✓ src/lib/dsl-validator.test.ts > AST Validation > should reject invalid identifiers
 ✓ src/lib/dsl-validator.test.ts > AST Validation > should reject invalid stock codes
 ✓ src/lib/dslCompiler.test.ts > compileDslToSql > should compile valid AST to SQL (property-based test)
 ✓ src/lib/dslCompiler.test.ts > compileDslToSql > should correctly compile MA function
 ✓ src/lib/dslCompiler.test.ts > compileDslToSql > should correctly compile RSI function
 ✓ src/lib/dslCompiler.test.ts > compileDslToSql > should correctly compile ATR function
 ✓ src/lib/dslCompiler.test.ts > compileDslToSql > should compile example AST from dummy_rsi_strategy.json to SQL
 ✓ src/lib/dslCompiler.test.ts > SQL Injection Prevention > should escape dangerous characters in identifiers
 ✓ src/lib/dslCompiler.test.ts > SQL Injection Prevention > should validate function names against whitelist
 ✓ src/lib/dslCompiler.test.ts > SQL Injection Prevention > should validate column names against whitelist
 ✓ src/types/__tests__/index.test.ts > BacktestRequest type > should validate BacktestRequest structure
 ✓ src/types/__tests__/index.test.ts > BacktestResponse type > should validate BacktestResponse structure

 Test Files  6 passed (6)
      Tests  19 passed (19)
   Start at  23:23:33
   Duration  1.72s (transform 236ms, setup 0ms, collect 718ms, tests 193ms, environment 2.50s, prepare 1.84s)

 % Coverage report from v8
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |    7.35 |    42.02 |   17.64 |    7.35 |                   
 backtest-app      |       0 |        0 |       0 |       0 |                   
  ...ght.config.ts |       0 |        0 |       0 |       0 | 1-85              
  ...ind.config.js |       0 |        0 |       0 |       0 | 1-8               
 ...t-app/fixtures |       0 |        0 |       0 |       0 |                   
  ...arket-data.js |       0 |        0 |       0 |       0 | 1-39              
 ...st-app/scripts |       0 |        0 |       0 |       0 |                   
  ...ummy-arrow.js |       0 |        0 |       0 |       0 | 1-126             
 backtest-app/src  |       0 |        0 |       0 |       0 |                   
  App.tsx          |       0 |        0 |       0 |       0 | 1-562             
  main.tsx         |       0 |        0 |       0 |       0 | 1-11              
 ...src/components |       0 |        0 |       0 |       0 |                   
  ApiKeyForm.tsx   |       0 |        0 |       0 |       0 | 1-90              
  ApiKeyModal.tsx  |       0 |        0 |       0 |       0 | 1-122             
  ...stResults.tsx |       0 |        0 |       0 |       0 | 1-86              
  ...urveChart.tsx |       0 |        0 |       0 |       0 | 1-77              
  ...csDisplay.tsx |       0 |        0 |       0 |       0 | 1-54              
  ProgressBar.tsx  |       0 |        0 |       0 |       0 | 1-23              
  ...dSelector.tsx |       0 |        0 |       0 |       0 | 1-175             
  ...kSelector.tsx |       0 |        0 |       0 |       0 | 1-89              
  ...egyEditor.tsx |       0 |        0 |       0 |       0 | 1-100             
  TradesTable.tsx  |       0 |        0 |       0 |       0 | 1-98              
  ...iodDialog.tsx |       0 |        0 |       0 |       0 | 1-112             
  WarningsList.tsx |       0 |        0 |       0 |       0 | 1-24              
 ...-app/src/hooks |       0 |        0 |       0 |       0 |                   
  useApiKeys.ts    |       0 |        0 |       0 |       0 | 1-53              
  useOhlcData.tsx  |       0 |        0 |       0 |       0 | 1-120             
 ...st-app/src/lib |   25.87 |    63.04 |   54.54 |   25.87 |                   
  cache.ts         |       0 |        0 |       0 |       0 | 1-132             
  dsl-validator.ts |     100 |      100 |     100 |     100 |                   
  dslCompiler.ts   |   88.07 |    67.56 |     100 |   88.07 | ...39,168-169,171 
  fetchJQuants.ts  |       0 |        0 |       0 |       0 | 1-212             
  geminiClient.ts  |       0 |        0 |       0 |       0 | 1-139             
  openaiClient.ts  |       0 |        0 |       0 |       0 | 1-91              
  ...ance.bench.ts |       0 |        0 |       0 |       0 | 1-159             
 ...-app/src/types |       0 |        0 |       0 |       0 |                   
  dslSchema.ts     |       0 |        0 |       0 |       0 | 1-102             
 ...app/src/worker |       0 |        0 |       0 |       0 |                   
  astToSql.ts      |       0 |        0 |       0 |       0 | 1-202             
  worker.ts        |       0 |        0 |       0 |       0 | 1-219             
-------------------|---------|----------|---------|---------|-------------------

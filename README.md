# 日本株クライアントサイド・バックテスト Web アプリ

DuckDB-WASM を使用したクライアントサイドの日本株バックテストアプリケーション。

## 🚀 現在の実装状況

### ✅ 完成済み機能

#### 基盤システム

- **アプリケーション基盤**: React + TypeScript + Vite
- **データ取得**: J-Quants API 連携
- **ステップワークフロー**: 段階的バックテスト実行フロー

#### 戦略エディター・分析

- **自然言語入力**: Gemini API による AST 生成
- **戦略分析**: 自動的な戦略タイプ検出と解釈
- **警告システム**: 問題のある戦略設定の検出
- **改善提案**: 戦略最適化のための具体的提案

#### データ処理

- **OHLC データ管理**: リアルタイムデータダウンロード
- **型安全性**: TypeScript 完全対応
- **エラーハンドリング**: 包括的なエラー処理

### 🚧 開発中・改善予定

#### 短期目標 (1-2 週間)

- **ストップ高戦略完全対応**
  - 前日データ参照 (lag 関数) の実装
  - ショートポジション対応
  - より正確なストップ高判定
- **UI/UX 改善**
  - 戦略修正支援機能
  - より詳細なエラーフィードバック

#### 中期目標 (1-2 ヶ月)

- **DuckDB-WASM バックテストエンジン**
  - AST→SQL 変換の完全実装
  - バックテスト実行機能
  - パフォーマンス指標計算
- **高度な戦略サポート**
  - 専用関数 (stop_high, lag, shift) の実装
  - 複雑なタイミング制御
  - マルチ銘柄対応

## 🛠️ 技術スタック

- **フロントエンド**: React 18, TypeScript, Tailwind CSS
- **バックテストエンジン**: DuckDB-WASM (実装予定)
- **データソース**: J-Quants API
- **AI/ML**: Google Gemini API (自然言語 →AST 変換)
- **ビルドツール**: Vite

## 📋 要件仕様

詳細な技術仕様は [REQUIREMENTS.md](./REQUIREMENTS.md) を参照してください。

## 🎯 開発ロードマップ

実装タスクとスケジュールは [TODO.md](./TODO.md) を参照してください。

## 🚀 セットアップ

```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# APIキーの設定
# ブラウザで http://localhost:5173 を開き、右上の「APIキー設定」から J-Quants Refresh Token を設定
```

## 📖 使用方法

1. **API キー設定**: J-Quants Refresh Token を設定
2. **データ取得**: 銘柄コードと期間を選択してデータをダウンロード
3. **戦略定義**: 自然言語で取引戦略を記述
4. **戦略分析**: 自動的な戦略解析と改善提案を確認
5. **バックテスト実行**: (実装予定) 戦略を実際に実行

## 🎯 戦略例

### 基本的な RSI 戦略

```
14日RSIが30以下で買い、70以上で売る
```

### 移動平均クロス戦略

```
5日移動平均が25日移動平均を上回ったら買い、下回ったら売る
```

### ストップ高戦略 (改善中)

```
ストップ高になったら引けで売る。翌日の引けで買いもどす。
```

## 🔧 開発者向け情報

### プロジェクト構造

```
src/
  ├── components/        # UIコンポーネント
  ├── hooks/            # カスタムフック
  ├── lib/              # ユーティリティ
  ├── types/            # 型定義
  └── worker/           # WebWorker (実装予定)
```

### テスト

```bash
# ユニットテスト
npm test

# E2Eテスト
npm run test:e2e

# パフォーマンステスト
npm run test:perf
```

## 📝 ライセンス

MIT License

## 🤝 コントリビューション

プルリクエストとイシューを歓迎します。大きな変更を行う場合は、事前にイシューを作成して議論してください。
